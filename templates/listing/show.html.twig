{% extends 'base.html.twig' %}

{% block title %}Listing{% endblock %}

{% block body %}
    <h1>Listing</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ listing.id }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td>{{ listing.title }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ listing.description }}</td>
            </tr>
            <tr>
                <th>Address</th>
                <td>{{ listing.address }}</td>
            </tr>
            <tr>
                <th>RentPrice</th>
                <td>{{ listing.rentPrice }}</td>
            </tr>
            <tr>
                <th>Availabefrom</th>
                <td>{{ listing.availableFrom|date('Y-m-d') }}</td>
            </tr>
            <tr>
                <th><i class="fas fa-user"></i> Owner</th>
                <td>{{ listing.owner.fullName }}</td>
            </tr>
            <tr>
                <th><i class="fas fa-phone"></i> Phone</th>
                <td>{{ listing.owner.phoneNumber }}</td>
            </tr>
            <tr>
                <th><i class="fas fa-calendar"></i> Published Date</th>
                <td>{{ listing.dateOfPublish|date('d/m/Y H:i') }}</td>
            </tr>
        </tbody>
    </table>

    <a href="{{ path('app_listing_index') }}">back to list</a>

    <!-- Show edit button only for owner or admin -->
    {% if is_granted('ROLE_ADMIN') or (app.user and app.user.id == listing.owner.id) %}
        <a href="{{ path('app_listing_edit', {'id': listing.id}) }}">edit</a>

        {{ include('listing/_delete_form.html.twig') }}
    {% endif %}

    <!-- Show reserve button only for ROLE_USER (not owner) -->
    {% if is_granted('ROLE_USER') and (not app.user or app.user.id != listing.owner.id) %}
        <a href="{{ path('app_booking_new', {'id': listing.id}) }}" class="btn btn-primary mt-3">
            <i class="fas fa-calendar-check"></i> RÃ©server
        </a>
    {% endif %}
{% endblock %}
